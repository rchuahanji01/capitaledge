import{a as f,I as $,h as z,ah as e,aq as H,ar as R,ap as P,ao as I}from"./index-Dddcwl5j.js";import{Q as K,V as X,H as N,W as Y,M as D,X as h,Y as _,Z as g,T as Z,_ as O}from"./IdurarOs-CKZOTyyW.js";import{u as M}from"./useMoney-B8kydoqy.js";import{D as G,E as J,s as q}from"./ErpApp-XK0FGIjv.js";import{u as U}from"./useFetch-BVNq2iLf.js";import{e as B}from"./actions-Dm21Ol5q.js";import{F as ee}from"./FilePdfOutlined-Dkb-rvMB.js";import{F as te}from"./Table-BeuXh3cf.js";import{T as ae}from"./index-B-2NCRZb.js";import{P as Q}from"./progress-zpQnkEgs.js";import{S as ne}from"./index-E-Z6dD8M.js";import"./index-BkIlcAT7.js";import"./DownOutlined-CVfGpTEk.js";var se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},re=function(a,s){return f.createElement($,z({},a,{ref:s,icon:se}))};const ie=f.forwardRef(re);var oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"},le=function(a,s){return f.createElement($,z({},a,{ref:s,icon:oe}))};const ce=f.forwardRef(le);function k({...t}){const a=N();let{entity:s,dataTableColumns:r}=t;const i=[{label:a("Show"),key:"read",icon:e.jsx(K,{})},{label:a("Edit"),key:"edit",icon:e.jsx(X,{})},{label:a("Download"),key:"download",icon:e.jsx(ee,{})}],c=H(),n=R(),l=o=>{n(B.currentItem({data:o})),c(`/${s}/read/${o._id}`)},d=o=>{n(B.currentAction({actionType:"update",data:o})),c(`/${s}/update/${o._id}`)},y=o=>{window.open(`${Y}${s}/${s}-${o._id}.pdf`,"_blank")};r=[...r,{title:"",key:"action",render:(o,L)=>e.jsx(G,{menu:{items:i,onClick:({key:j})=>{switch(j){case"read":l(L);break;case"edit":d(L);break;case"download":y(L);break}}},trigger:["click"],children:e.jsx(J,{style:{cursor:"pointer",fontSize:"24px"},onClick:j=>j.preventDefault()})})}];const x=()=>D.list({entity:s}),{result:v,isLoading:A,isSuccess:p}=U(x),b=()=>p&&v?v.slice(0,5):[];return e.jsx(te,{columns:r,rowKey:o=>o._id,dataSource:p&&b(),pagination:!1,loading:A,scroll:{x:!0}})}function S({title:t,tagColor:a,data:s,prefix:r,isLoading:i=!1}){const{moneyFormatter:c}=M(),n=P(q);return e.jsx(h,{className:"gutter-row",xs:{span:24},sm:{span:12},md:{span:12},lg:{span:6},children:e.jsxs("div",{className:"whiteBox shadow",style:{color:"#595959",fontSize:13,minHeight:"106px",height:"100%"},children:[e.jsx("div",{className:"pad15 strong",style:{textAlign:"center",justifyContent:"center"},children:e.jsx("h3",{style:{color:"#22075e",fontSize:"large",margin:"5px 0",textTransform:"capitalize"},children:t})}),e.jsx(_,{style:{padding:0,margin:0}}),e.jsx("div",{className:"pad15",children:e.jsxs(g,{gutter:[0,0],justify:"space-between",wrap:!1,children:[e.jsx(h,{className:"gutter-row",flex:"85px",style:{textAlign:"left"},children:e.jsx("div",{className:"left",style:{whiteSpace:"nowrap"},children:r})}),e.jsx(_,{style:{height:"100%",padding:"10px 0",justifyContent:"center",alignItems:"center"},type:"vertical"}),e.jsx(h,{className:"gutter-row",flex:"auto",style:{display:"flex",justifyContent:"center",alignItems:"center"},children:i?e.jsx(I,{}):e.jsx(Z,{title:s,style:{direction:"ltr"},children:e.jsx(ae,{color:a,style:{margin:"0 auto",justifyContent:"center",maxWidth:"110px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",direction:"ltr"},children:c(s?{amount:s,currency_code:n==null?void 0:n.default_currency_code}:{amount:0,currency_code:n==null?void 0:n.default_currency_code})})})})]})})]})})}const de={draft:"#595959",sent:"#1890ff",pending:"#1890ff",unpaid:"#ffa940",overdue:"#ff4d4f",partially:"#13c2c2",paid:"#95de64",declined:"#ff4d4f",accepted:"#95de64",cyan:"#13c2c2",purple:"#722ed1",expired:"#614700"},E=[{tag:"draft",value:0},{tag:"pending",value:0},{tag:"sent",value:0},{tag:"accepted",value:0},{tag:"declined",value:0},{tag:"expired",value:0}],ue=[{tag:"draft",value:0},{tag:"pending",value:0},{tag:"overdue",value:0},{tag:"paid",value:0},{tag:"unpaid",value:0},{tag:"partially",value:0}],pe=({tag:t,value:a})=>{const s=N();return e.jsxs("div",{style:{color:"#595959",marginBottom:5},children:[e.jsx("div",{className:"left alignLeft capitalize",children:s(t)}),e.jsxs("div",{className:"right alignRight",children:[a," %"]}),e.jsx(Q,{percent:a,showInfo:!1,strokeColor:{"0%":"#333","100%":"#333"}})]})};function he({title:t="Preview",statistics:a=E,isLoading:s=!1,entity:r="invoice"}){const i=f.useMemo(()=>r==="invoice"?ue.map(n=>(Array.isArray(a)?a.find(d=>d.tag===n.tag):null)||n):E.map(n=>(Array.isArray(a)?a.find(d=>d.tag===n.tag):null)||n),[a,r]),c=(n,l)=>{const d=Object.values(de),y=d.indexOf(n.props.color),x=d.indexOf(l.props.color);return y-x};return e.jsx(h,{className:"gutter-row",xs:{span:24},sm:{span:24},md:{span:12},lg:{span:12},children:e.jsxs("div",{className:"pad20",children:[e.jsx("h3",{style:{color:"#22075e",fontSize:"large",marginBottom:40,marginTop:0},children:t}),s?e.jsx("div",{style:{textAlign:"center"},children:e.jsx(I,{})}):i==null?void 0:i.map((n,l)=>e.jsx(pe,{tag:n.tag,value:n==null?void 0:n.value},l)).sort(c)]})})}function xe({isLoading:t=!1,activeCustomer:a=0,newCustomer:s=0}){const r=N();return e.jsx(g,{className:"gutter-row",children:e.jsx("div",{className:"whiteBox shadow",style:{height:458},children:e.jsxs("div",{className:"pad20",style:{textAlign:"center",justifyContent:"center"},children:[e.jsx("h3",{style:{color:"#333",marginBottom:40,marginTop:15,fontSize:"large"},children:r("Customers")}),t?e.jsx(I,{}):e.jsxs("div",{style:{display:"grid",justifyContent:"center"},children:[e.jsx(Q,{type:"dashboard",percent:s,size:148}),e.jsx("p",{children:r("New Customer this Month")}),e.jsx(_,{}),e.jsx(ne,{title:r("Active Customer"),value:a,precision:2,valueStyle:a>0?{color:"#333"}:a<0?{color:"#333"}:{color:"#000000"},prefix:a>0?e.jsx(ce,{}):a<0?e.jsx(ie,{}):null,suffix:"%"})]})]})})})}function me(){const t=N(),{moneyFormatter:a}=M(),s=P(q),r=async({entity:u,currency:w})=>await D.summary({entity:u,options:{currency:w}}),{result:i,isLoading:c,onFetch:n}=O(),{result:l,isLoading:d,onFetch:y}=O(),{result:x,isLoading:v,onFetch:A}=O(),{result:p,isLoading:b}=U(()=>D.summary({entity:"client"}));f.useEffect(()=>{const u=s.default_currency_code||null;u&&(n(r({entity:"invoice",currency:u})),y(r({entity:"quote",currency:u})),A(r({entity:"payment",currency:u})))},[s.default_currency_code]);const o=[{title:t("number"),dataIndex:"number"},{title:t("Client"),dataIndex:["client","name"]},{title:t("Total"),dataIndex:"total",onCell:()=>({style:{textAlign:"right",whiteSpace:"nowrap",direction:"ltr"}}),render:(u,w)=>a({amount:u,currency_code:w.currency})},{title:t("Status"),dataIndex:"status"}],j=[{result:i,isLoading:c,entity:"invoice",title:t("Invoices")},{result:l,isLoading:d,entity:"quote",title:t("quote")}].map((u,w)=>{var F;const{result:C,entity:V,isLoading:T,title:W}=u;return e.jsx(he,{title:W,isLoading:T,entity:V,statistics:!T&&((F=C==null?void 0:C.performance)==null?void 0:F.map(m=>({tag:m==null?void 0:m.status,color:"blue",value:m==null?void 0:m.percentage})))},w)});return s?e.jsxs(e.Fragment,{children:[e.jsxs(g,{gutter:[32,32],children:[e.jsx(S,{title:t("Invoices"),prefix:t("This month"),isLoading:c,data:i==null?void 0:i.total}),e.jsx(S,{title:t("Quote"),prefix:t("This month"),isLoading:d,data:l==null?void 0:l.total}),e.jsx(S,{title:t("paid"),prefix:t("This month"),isLoading:v,data:x==null?void 0:x.total}),e.jsx(S,{title:t("Unpaid"),prefix:t("Not Paid"),isLoading:c,data:i==null?void 0:i.total_undue})]}),e.jsx("div",{className:"space30"}),e.jsxs(g,{gutter:[32,32],children:[e.jsx(h,{className:"gutter-row w-full",sm:{span:24},md:{span:24},lg:{span:18},children:e.jsx("div",{className:"whiteBox shadow",style:{height:458},children:e.jsx(g,{className:"pad20",gutter:[0,0],children:j})})}),e.jsx(h,{className:"gutter-row w-full",sm:{span:24},md:{span:24},lg:{span:6},children:e.jsx(xe,{isLoading:b,activeCustomer:p==null?void 0:p.active,newCustomer:p==null?void 0:p.new})})]}),e.jsx("div",{className:"space30"}),e.jsxs(g,{gutter:[32,32],children:[e.jsx(h,{className:"gutter-row w-full",sm:{span:24},lg:{span:12},children:e.jsxs("div",{className:"whiteBox shadow pad20",style:{height:"100%"},children:[e.jsx("h3",{style:{color:"#22075e",marginBottom:5,padding:"0 20px 20px"},children:t("Recent Invoices")}),e.jsx(k,{entity:"invoice",dataTableColumns:o})]})}),e.jsx(h,{className:"gutter-row w-full",sm:{span:24},lg:{span:12},children:e.jsxs("div",{className:"whiteBox shadow pad20",style:{height:"100%"},children:[e.jsx("h3",{style:{color:"#22075e",marginBottom:5,padding:"0 20px 20px"},children:t("Recent Quotes")}),e.jsx(k,{entity:"quote",dataTableColumns:o})]})})]})]}):e.jsx(e.Fragment,{})}function De(){return e.jsx(me,{})}export{De as default};
